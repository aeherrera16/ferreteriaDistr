<h2>Registrar Artículo</h2>
<form method="post" action="/articulos/crear">
  <label>Código <input name="codigo" value="<%= data.Codigo||'' %>" /></label>
  <span style="color: red"><%= errors.Codigo||'' %></span>
  <label>Nombre <input name="nombre" value="<%= data.Nombre||'' %>" /></label>
  <span style="color: red"><%= errors.Nombre||'' %></span>
  <label>
    Categoría
    <select name="categoria" id="categoria-select">
      <option value="">Seleccione una categoría</option>
    </select>
  </label>
  <label
    >Precio compra
    <input
      name="precio_compra"
      type="number"
      step="0.01"
      value="<%= data.PrecioCompra||'' %>"
      min="0"
    />
  </label>
  <span style="color: red"><%= errors.PrecioCompra||'' %></span>
  <label
    >Precio venta
    <input
      name="precio_venta"
      type="number"
      step="0.01"
      value="<%= data.PrecioVenta||'' %>"
      min="0"
    />
  </label>
  <span style="color: red"><%= errors.PrecioVenta||'' %></span>
  <label
    >Stock
    <input name="stock" type="number" value="<%= data.Stock||'' %>" min="0"
  /></label>
  <span style="color: red"><%= errors.Stock||'' %></span>
  <label
    >Stock mínimo
    <input
      name="stock_minimo"
      type="number"
      value="<%= data.StockMinimo||'' %>"
      min="0"
    />
  </label>
  <span style="color: red"><%= errors.StockMinimo||'' %></span>
  <label>
    Proveedor
    <select name="proveedor" id="proveedor-select">
      <option value="">Seleccione un proveedor</option>
    </select>
  </label>
  <button>Guardar</button>
</form>
<script>
  // Llenar select de categorías
  fetch("/articulos/api/categorias")
    .then((res) => res.json())
    .then((data) => {
      const select = document.getElementById("categoria-select");
      data.forEach((cat) => {
        const opt = document.createElement("option");
        opt.value = cat.id;
        opt.textContent = cat.nombre;
        if ("<%= data.Categoria||'' %>" == cat.id) opt.selected = true;
        select.appendChild(opt);
      });
    });
  // Llenar select de proveedores
  fetch("/articulos/api/proveedores")
    .then((res) => res.json())
    .then((data) => {
      const select = document.getElementById("proveedor-select");
      data.forEach((prov) => {
        const opt = document.createElement("option");
        opt.value = prov.id;
        opt.textContent = prov.nombre;
        if ("<%= data.Proveedor||'' %>" == prov.id) opt.selected = true;
        select.appendChild(opt);
      });
    });
</script>
<% if (serverMsg) { %>
<p><%= serverMsg %></p>
<% } %>
